<ul class="menu nav-sidebar">
  <li class="" id="<%= 'home' %>" title="<%=ui_resources['home'].description %>">
    <a  href="#"><h4><%= ui_resources['home'].title %></h4></a>
  </li>
  <%
  _.each(_(menu['submenus']).keys(), function(key){
    var ui_resource = ui_resources[key];
  %>
    <li class="" id="<%= key %>" title="<%=ui_resource.description %>">
    <a href="#"><strong><%= ui_resource.title %></a></strong></li>
  <%
		var submenu = menu['submenus'][key];
    if( submenu['expanded'] ) {
	    console.log('get submenus for: ' + key + ', ' + JSON.stringify(submenu['submenus']));
	    var submenus = submenu['submenus'];
	    if( !_.isEmpty(submenus)){
  %>
        <ul  class="menu nav-sidebar">
  <%
				_.each(_.keys(submenus), function(key){
			    var ui_resource = ui_resources[key];
			    if(_.isUndefined(ui_resource)){
			      console.log('error, undefined ui_resource:' + JSON.stringify(key) );
			    }else{
			      console.log('found ' + key);
   %>
            <li  class="" id="<%= key %>" title="<%=ui_resource.description %>"><a href="#"><%= ui_resource.title %></a></li>
   <%
          }
        });
      }
   %>
      </ul>
   <%
    }
  });
  %>
</ul>
