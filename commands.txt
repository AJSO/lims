# Useful dev commands:

# copy production settings to server:
scp /home/sde4/workspace/iccbl-lims/lims/static/production_data/* orchestra.med.harvard.edu:/www/dev.screensaver2.med.harvard.edu/support/production_data/

# run migration script for branch library1 using repo: seanderickson

bash -x ./migration.sh library1 seanderickson migration.properties

# Re-initialize the meta data for the site
PYTHONPATH=. python reports/utils/db_init.py --input_dir=./reports/static/api_init/ -f ./reports/static/api_init/api_init_actions.csv -u http://localhost:8000/reports/api/v1 -U sde
PYTHONPATH=. python reports/utils/db_init.py --input_dir=./db/static/api_init/ -f ./db/static/api_init/api_init_actions.csv -u http://localhost:8000/reports/api/v1 -U sde

# to profile
# add the profile path to the settings.py
# base path for profiling
PROFILE_LOG_BASE='/tmp'
# add a decorator to a function:
    @profile("unlimited_get_list.prof")
# then analyze the outpufile:
PYTHONPATH=. python reports/utils/profile_decorator.py /tmp/unlimited_get_list-20141031T193039.prof 

# run all tests
./manage.py test db.tests.LibraryResource --verbosity=2 --settings=lims.settings_testing

# run tests without the test db
./manage.py test reports.SDFSerializerTest.test2_clean_data_sdf --settings=lims.settings_testing_nodb

# upload single meta data files
# TODO: patching is not working ---
curl -v  --dump-header - -H "Content-Type: text/csv" --user sde -X PATCH http://localhost:8000/reports/api/v1/metahash/ --data-binary @db/static/api_init/metahash_fields_library.csv 

curl -v  --dump-header - -H "Content-Type: text/csv" --user sde -X PATCH http://localhost:8000/reports/api/v1/metahash/ --data-binary @reports/static/api_init/metahash_fields_apilog.csv

curl -v  --dump-header - -H "Content-Type: text/csv" --user sde -X PATCH http://localhost:8000/reports/api/v1/metahash/ --data-binary @reports/static/api_init/metahash_fields_initial_patch.csv

curl -v  --dump-header - -H "Content-Type: text/csv" --user sde -X PATCH http://localhost:8000/reports/api/v1/vocabularies/ --data-binary @db/static/api_init/vocabularies_data.csv

curl -v  --dump-header - -H "Content-Type: text/csv" --user sde -X PATCH http://localhost:8000/reprts/api/v1/resource/ --data-binary @db/static/api_init/metahash_resource_data.csv
